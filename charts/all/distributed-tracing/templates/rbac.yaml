{{- if .Values.tracing.rbac.enabled }}
{{- range .Values.tracing.collectors }}
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: {{ printf "%s-%s-traces-write" (include "distributed-tracing.fullname" $) .name }}
rules:
  - apiGroups: ["tempo.grafana.com"]
    resources: ["{{ .name }}"]
    resourceNames: ["traces"]
    verbs: ["create"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: {{ printf "%s-%s-traces-write" (include "distributed-tracing.fullname" $) .name }}
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: {{ printf "%s-%s-traces-write" (include "distributed-tracing.fullname" $) .name }}
subjects:
  - kind: ServiceAccount
    name: {{ printf "%s-collector" .name }}
    namespace: {{ .namespace }}
{{- end }}
{{- end }}
